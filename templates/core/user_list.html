{% extends 'base.html' %}
{% block title %}User List{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2 class="mb-3">Users</h2>

  {% if messages %}
    <div class="mb-3">
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}

  <table class="table table-striped table-hover align-middle shadow-sm">
    <thead class="table-dark">
      <tr>
        <th>Username</th>
        <th>Full name</th>
        <th>Email</th>
        <th>Role</th>
        <th>Active</th>
        {% if can_delete %}
          <th class="text-center">Actions</th>
        {% endif %}
      </tr>
    </thead>
    <tbody>
      {% for user, role in users_with_role %}
        <tr>
          <td>{{ user.username }}</td>
          <td>{{ user.first_name }}</td>
          <td>{{ user.email }}</td>
          <td>{{ role }}</td>
          <td>{% if user.is_active %}Yes{% else %}No{% endif %}</td>

          {% if can_delete %}
            <td class="text-center">
              {% if user != request.user %}
                <a href="{% url 'core:delete_user' user.id %}" 
                   class="btn btn-sm btn-outline-danger"
                   onclick="return confirm('Are you sure you want to delete user {{ user.username }}?');">
                   Delete
                </a>
              {% else %}
                <span class="text-muted">â€”</span>
              {% endif %}
            </td>
          {% endif %}
        </tr>
      {% empty %}
        <tr>
          <td colspan="{% if can_delete %}6{% else %}5{% endif %}" class="text-center text-muted">
            No users yet.
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
